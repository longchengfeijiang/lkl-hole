
  <view>
    <view class="container">
      <view class="page page-list {{ tab === 0 ? 'visible' : 'hide' }}">
        
  <view class="main-list">
    <view class="ads"  wx:if="{{ $list$ads.length > 0 && $list$showAd }}">
      <navigator url="/pages/detail?id={{ $list$ad.bid }}" open-type="navigate">
        <image src="{{ $list$ad.image }}" class="ad-image"/>
      </navigator>
      <view class="close-btn" bindtap="$list$closeAd">
        <image src="../assets/svgs/close-ad.svg"/>
      </view>
    </view>
    
  <view class="list-container">
    <navigator url="/pages/new" open-type="navigate" hover-class="newBtn-hover" hover-stay-time="200" class="newBtn">
      <image src="../assets/svgs/write.svg" class="newBtn-icon"/>
    </navigator>
    <navigator  wx:for="{{ $list$clist$list }}" wx:for-item="item" wx:key="{{ idx }}" wx:for-index="idx" url="/pages/detail?id={{ item.id }}" open-type="navigate" class="list-item">
      <view class="list-item-fixed" wx:if="{{ item.isFixed }}">置顶</view>
      <!-- User Info -->
      <view class="list-user">
        <view class="list-user-avatar">
          <image class="avatar" src="{{ item.user.avatar === '../../assert/avatar.png' ? '../assets/svgs/avatar/avatar.svg' : item.user.avatar }}">
          </image>
        </view>
        <view class="list-user-info">
          <view class="list-user-nickname">
            <text class="nickname">{{ item.user.nickname }}</text>
            <image wx:if="{{ item.user.isVerified }}" class="verify" src="../assets/svgs/person-v.svg">
            </image>
          </view>
          <text class="time-and-from">{{ item.time + ' 来自' + item.device }}</text>
        </view>
      </view>
      <!-- Blog Body -->
      <view class="list-item-body">
        <text class="list-item-body-content">{{ item.text }}</text>
        <view class="list-item-body-images" wx:if="{{ item.images.length !== 0 }}">
          <image wx:for-item="image" wx:for="{{ item.images }}" wx:for-index="i" wx:key="{{ i }}" catchtap="$list$clist$viewPic" src="{{ image }}" class="list-item-body-image" mode="aspectFill" data-wpyviewpic-a="{{ image }}" data-wpyviewpic-b="{{ item.images }}">
          </image>
        </view>
        <view class="list-item-location" wx:if="{{ item.location.locationName }}" catchtap="$list$clist$showLocation" data-wpyshowlocation-a="{{ item.location.latitude }}" data-wpyshowlocation-b="{{ item.location.longitude }}">
          <image class="location-icon" src="../assets/svgs/location.svg"/>
          <text>{{ item.location.locationName }}</text>
        </view>
      </view>
      <!-- Blog Operations -->
      <view class="list-item-operations" wx:if="{{ !$list$clist$isTest }}">
        <view catchtap="$list$clist$like" hover-class="list-item-operation-like-scale" class="list-item-operation-like" data-wpylike-a="{{ idx }}" data-wpylike-b="{{ item.id }}">
          <image class="list-item-operation-icon" src="{{ item.like ? '../assets/svgs/like-fill.svg' : '../assets/svgs/like.svg' }}"/>
          <text class="number {{ item.like ? 'active' : '' }}" wx:if="{{ item.likeNum !== 0 }}">{{ item.likeNum }}</text>
        </view>
        <navigator url="/pages/detail?id={{ item.id }}&focusComment=true" open-type="navigate" class="list-item-operation-comment">
          <image class="list-item-operation-icon" src="../assets/svgs/comment.svg"/>
          <text class="number" wx:if="{{ item.commentNum !== 0 }}">{{ item.commentNum }}</text>
        </navigator>
        <view catchtap="$list$clist$showMore" class="list-item-operation-more" wx:if="{{ item.user.isAdmin || item.user.isAuthor }}" data-wpyshowmore-a="{{ idx }}" data-wpyshowmore-b="{{ item.id }}">
          <image class="list-item-operation-icon" src="../assets/svgs/more.svg"/>
        </view>
      </view>
    </navigator>
  </view>

  </view>

      </view>
      <view class="page {{ tab === 1 ? 'visible' : 'hide' }}">
        
  <scroll-view scroll-y="true" bindscrolltolower="$message$loadNextPage" class="list">
    <view class="operations">
      <view class="operation markAllRead" catchtap="$message$markAllRead" data-wpymarkallread-a="">
        <image src="../assets/svgs/markAllRead.svg"/>
        <text>全部标为已读</text>
      </view>
      <view class="operation refresh" catchtap="$message$refresh" data-wpyrefresh-a="">
        <image src="../assets/svgs/refresh.svg"/>
        <text>刷新</text>
      </view>
    </view>
    <view  wx:for="{{ $message$list }}" wx:for-item="item" wx:key="{{ idx }}" wx:for-index="idx" catchtap="$message$jumpTo" class="item {{ item.isUnread ? 'unread' : 'read' }}" data-wpyjumpto-a="{{ item.bid }}" data-wpyjumpto-b="{{ item.nid }}">
      <view class="avatar">
        <image src="{{ item.user.avatar }}" class="avatar-image"/>
      </view>
      <view class="content">
        <view class="userinfo">
          <text class="nickname">{{ item.user.nickname }}</text>
          <text class="time"> {{ item.time }}</text>
        </view>
        <text class="message-content">{{ item.content }}</text>
      </view>
    </view>
  </scroll-view>

      </view>
      <view class="page {{ tab === 2 ? 'visible' : 'hide' }}">
        
  <scroll-view scroll-y="true" bindscrolltolower="$user$loadNext" class="user">
    <view class="userinfo">
      <view class="avatar">
        <image src="{{ $user$userinfo.avatarUrl }}" class="avatar-image"/>
      </view>
      <view class="nickname">
        <text>{{ $user$userinfo.nickName }}</text>
      </view>
    </view>
    <view class="blogs">
      <navigator  wx:for="{{ $user$blogs }}" wx:for-item="item" wx:key="{{ idx }}" wx:for-index="idx" url="/pages/detail?id={{ item.id }}" open-type="navigate" class="item-body">
        <text class="item-body-content">{{ item.content }}</text>
        <view class="item-body-images" wx:if="{{ item.images.length !== 0 }}">
          <image wx:for-item="image" wx:for="{{ item.images }}" wx:for-index="i" wx:key="{{ i }}" catchtap="$user$viewPic" src="{{ image }}" class="item-body-image" mode="aspectFill" data-wpyviewpic-a="{{ image }}" data-wpyviewpic-b="{{ item.images }}">
          </image>
        </view>
        <view class="item-location" wx:if="{{ item.location }}" catchtap="$user$showLocation" data-wpyshowlocation-a="{{ item.latitude }}" data-wpyshowlocation-b="{{ item.longitude }}">
          <image class="location-icon" src="../assets/svgs/location.svg"/>
          <text>{{ item.location }}</text>
        </view>
      </navigator>
    </view>
  </scroll-view>

      </view>
    </view>
    <view class="tabs"  wx:if="{{ showTabs }}">
      <view class="tab" bindtap="switchTapTo" data-wpyswitchtapto-a="0">
        <image src="../assets/svgs/home-fill.svg" wx:if="{{ tab === 0 }}"/>
        <image src="../assets/svgs/home.svg" wx:else/>
      </view>
      <view class="tab" bindtap="switchTapTo" data-wpyswitchtapto-a="1">
        <image src="../assets/svgs/message-fill.svg" wx:if="{{ tab === 1 }}"/>
        <image src="../assets/svgs/message.svg" wx:else/>
        <view class="badge badge-number" wx:if="{{ unreadMessagesCount !== 0 }}">{{ unreadMessagesCount }}</view>
      </view>
      <view class="tab" bindtap="switchTapTo" data-wpyswitchtapto-a="2">
        <image src="../assets/svgs/my-fill.svg" wx:if="{{ tab === 2 }}"/>
        <image src="../assets/svgs/my.svg" wx:else/>
      </view>
    </view>
  </view>